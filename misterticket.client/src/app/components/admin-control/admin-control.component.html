<div class="container mt-5">
  <div class="header-actions">
    <button class="btn-back" routerLink="/">
      <i class="bi bi-arrow-left"></i> Retour à l'accueil
    </button>
  </div>

  <h2 class="mb-4 text-center">Panneau d'Administration</h2>

  <div *ngIf="errorMessage" class="alert alert-danger alert-dismissible fade show">
    {{ errorMessage }}
    <button type="button" class="btn-close" (click)="errorMessage = ''"></button>
  </div>

  <ul class="nav nav-tabs mb-4">
    <li class="nav-item">
      <button class="nav-link" [class.active]="activeTab === 'users'" (click)="activeTab = 'users'">Utilisateurs</button>
    </li>
    <li class="nav-item">
      <button class="nav-link" [class.active]="activeTab === 'events'" (click)="activeTab = 'events'">Événements</button>
    </li>
    <li class="nav-item">
      <button class="nav-link" [class.active]="activeTab === 'scenes'" (click)="activeTab = 'scenes'">Salles (Scènes)</button>
    </li>
  </ul>

  <div *ngIf="activeTab === 'users'">
    <table class="table table-striped table-hover">
      <thead class="table-dark">
        <tr>
          <th>ID</th>
          <th>Nom</th>
          <th>Email</th>
          <th>Rôle</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let user of users">
          <td>{{ user.id }}</td>
          <td>{{ user.name }}</td>
          <td>{{ user.email }}</td>
          <td>
            <select class="form-select form-select-sm" [(ngModel)]="user.role" (change)="changeRole(user, user.role)">
              <option value="Customer">Client</option>
              <option value="Organiser">Organisateur</option>
              <option value="Admin">Admin</option>
            </select>
          </td>
          <td>
            <button class="btn btn-danger btn-sm" (click)="deleteUser(user.id)">Supprimer</button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div *ngIf="activeTab === 'events'">
    <div class="mb-3 text-end">
      <a routerLink="/organiser/create-event" class="btn btn-success">+ Créer un événement</a>
    </div>
    <table class="table table-striped">
      <thead class="table-dark">
        <tr>
          <th>Image</th>
          <th>Nom</th>
          <th>Date</th>
          <th>Lieu</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let event of events">
          <td>
            <img *ngIf="event.imageUrl" [src]="event.imageUrl" alt="img" style="width: 50px; height: 50px; object-fit: cover; border-radius: 5px;">
          </td>
          <td>{{ event.name }}</td>
          <td>{{ event.date | date:'dd/MM/yyyy HH:mm' }}</td>
          <td>{{ event.sceneName }}</td>
          <td>
            <button class="btn btn-primary btn-sm me-2" (click)="modifyEvent(event.id)">Modifier</button>
            <button class="btn btn-danger btn-sm" (click)="deleteEvent(event.id)">Supprimer</button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div *ngIf="activeTab === 'scenes'">
    <div class="mb-3 text-end">
      <a routerLink="/organiser/create-scene" class="btn btn-success">+ Créer une salle</a>
    </div>
    <table class="table table-striped">
      <thead class="table-dark">
        <tr>
          <th>ID</th>
          <th>Nom</th>
          <th>Capacité (Col x Rang)</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let scene of scenes">
          <td>{{ scene.id }}</td>
          <td>{{ scene.name }}</td>
          <td>{{ scene.maxColumns * scene.maxRows }} places</td>
          <td>
            <button class="btn btn-primary btn-sm me-2" (click)="modifyScene(scene.id)">Modifier</button>
            <button class="btn btn-danger btn-sm" (click)="deleteScene(scene.id)">Supprimer</button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>
